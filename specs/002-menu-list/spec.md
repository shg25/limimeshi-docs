# Feature Specification: メニュー一覧（Menu List）

**Feature Branch**: `phase1-2-mvp-specs`  
**Created**: 2025-11-14  
**Status**: Draft  
**Input**: User description: "一般ユーザー向けのメニュー一覧画面。期間限定メニューを一覧表示し、ログインユーザーはお気に入り登録したチェーンのみ表示するフィルタを利用可能。各メニューにはチェーン名、メニュー名、販売開始日時、販売終了日時（未設定時は非表示）、ステータス（予定/発売から◯日経過/販売終了）、説明を表示。X Post URLがあれば埋め込み表示（商品画像代わり）。販売開始日時の降順（新しい順）でソート。1年経過したメニューは非表示。ログインユーザーのフィルタ選択は次回訪問時も保持。Phase2 MVPで実装。管理画面で登録されたデータを表示する読み取り専用機能。"  

## User Scenarios & Testing *(mandatory)*

### User Story 1 - メニュー一覧の閲覧 (Priority: P1)

一般ユーザーが期間限定メニューを一覧表示し、最新のメニュー情報を素早く確認できる。これがサービスの中心的価値であり、ユーザーが最も頻繁に利用する機能。

**Why this priority**: 期間限定メニューの情報提供がサービスの主要価値。これがなければユーザーに提供する価値がない。

**Independent Test**: メニューの一覧表示が正しく動作し、販売開始日時の降順でソートされ、各メニューの詳細情報が表示されれば、独立して価値を提供できる。

**Acceptance Scenarios**:

1. **Given** 管理画面でメニューが複数登録済み, **When** ユーザーがメニュー一覧画面を開く, **Then** 販売開始日時から1年以内のメニューが販売開始日時の降順（新しい順）で表示される
2. **Given** メニュー一覧が表示されている, **When** ユーザーが各メニューを確認, **Then** チェーン名、メニュー名、販売開始日時、ステータス（自動判定）、説明が表示される
3. **Given** メニュー一覧が表示されている, **When** メニューに販売終了日時が設定されている, **Then** 販売終了日時が表示される
4. **Given** メニュー一覧が表示されている, **When** メニューに販売終了日時が未設定, **Then** 販売終了日時フィールドは表示されない
5. **Given** メニュー一覧が表示されている, **When** メニューにX Post URLが登録されている, **Then** X Postが埋め込み表示される（商品画像を含む）
6. **Given** メニュー一覧が表示されている, **When** メニューにX Post URLが登録されていない, **Then** X Post埋め込みは表示されない
7. **Given** 販売開始日時から1年以上経過したメニューが存在, **When** ユーザーがメニュー一覧画面を開く, **Then** そのメニューは表示されない
8. **Given** 管理画面でメニューが0件, **When** ユーザーがメニュー一覧画面を開く, **Then** 「データなし」と表示される

---

### User Story 2 - お気に入りチェーンフィルタ (Priority: P1)

ログインユーザーがお気に入り登録したチェーン店のメニューのみを表示し、関心の高いチェーンの新メニューを素早く確認できる。フィルタ選択は次回訪問時も保持される。

**Why this priority**: お気に入り機能（003）に依存するが、頻繁に使われる重要な機能。ユーザーは同じチェーンを繰り返し確認する傾向があるため、フィルタ選択の永続化と合わせて体験価値が高い。

**Independent Test**: お気に入りフィルタが正しく動作し、お気に入り登録済みチェーンのメニューのみが表示され、フィルタ選択が次回訪問時も保持されれば、独立して価値を提供できる。

**Acceptance Scenarios**:

1. **Given** ログインユーザーがお気に入りチェーンを1件以上登録済み, **When** ユーザーが「お気に入りのみ表示」フィルタをON, **Then** お気に入り登録したチェーンのメニューのみが表示される
2. **Given** お気に入りフィルタがON, **When** ユーザーがフィルタをOFF, **Then** 全てのメニューが再び表示される
3. **Given** ログインユーザーがお気に入りチェーンを0件登録, **When** ユーザーが「お気に入りのみ表示」フィルタをON, **Then** 「データなし」と表示される
4. **Given** ログインユーザーがお気に入りフィルタをONに設定, **When** ユーザーが次回サイトを訪問, **Then** 前回のフィルタ設定（お気に入りON）が保持されている

---

### Edge Cases

- **メニュー0件**: 管理画面でメニューが1件も登録されていない場合、「データなし」と表示する
- **お気に入り0件**: お気に入りチェーンが0件の場合、「データなし」と表示する
- **X Post URL未設定**: X Post URLが登録されていない場合、X Post埋め込み非表示
- **X Postに画像がない場合**: X Postに画像が添付されていない場合でも、Postテキストのみ埋め込み表示される
- **X Post削除リスク**: Post作成者がPostを削除した場合、埋め込み表示ができなくなる（外部依存の制約として受け入れる）
- **販売終了日時未設定**: 販売終了日時が未設定の場合、販売終了日時フィールドは非表示。ステータスは「予定」または「発売から◯日経過」「発売から◯ヶ月以上経過」として自動判定される
- **大量メニュー**: メニューが500件を超えた場合はページネーション検討、1000件を超えた場合は必須（Phase3で実装）

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは販売開始日時から1年以内の期間限定メニューを一覧表示しなければならない
- **FR-002**: システムはメニューを販売開始日時の降順（新しい順）で表示しなければならない
- **FR-003**: システムは各メニューにチェーン名、メニュー名、販売開始日時、ステータス（自動判定）、説明を表示しなければならない
- **FR-004**: システムはメニューに販売終了日時が設定されている場合のみ、販売終了日時を表示しなければならない
- **FR-005**: システムはメニューにX Post URLが登録されている場合、X Postを埋め込み表示しなければならない
- **FR-006**: システムはメニューにX Post URLが登録されていない場合、X Post埋め込みを表示してはならない
- **FR-007**: システムはお気に入りチェーンフィルタを提供し、ログインユーザーがお気に入り登録済みチェーンのメニューのみを表示できなければならない
- **FR-008**: システムはユーザーのフィルタ選択（全て表示/お気に入りのみ表示）を保存し、次回訪問時も保持しなければならない
- **FR-009**: システムはメニューが0件の場合、「データなし」と表示しなければならない
- **FR-010**: システムはお気に入りフィルタ適用時にメニューが0件の場合、「データなし」と表示しなければならない
- **FR-011**: システムは販売開始日時から1年以上経過したメニューを一覧に表示してはならない
- **FR-012**: システムはメニューのステータスを販売開始日時と販売終了日時から自動判定しなければならない（予定/発売から◯日経過/発売から◯ヶ月以上経過/販売終了）

### Key Entities

- **Menu（メニュー）**: 期間限定メニューの情報を表す。管理画面で登録されたデータを読み取り専用で表示する。チェーン名、メニュー名、販売開始日時、販売終了日時、ステータス（自動判定）、説明、X Post URLを持つ。
- **Chain（チェーン店）**: メニューの親エンティティ。フィルタリングに使用される。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: メニュー一覧のページ読み込み時間が3秒以内である（モバイル4G環境、X Post埋め込み部分を除く）
- **SC-002**: ユーザーが興味のあるメニューを10秒以内に見つけられる
- **SC-003**: お気に入りフィルタの操作が1秒以内に完了する
- **SC-004**: メニューが0件の場合、適切なメッセージが即座に表示される
- **SC-005**: フィルタ選択が次回訪問時に正しく保持されている（100%の確率）

## Assumptions *(optional)*

- メニューデータは管理画面で事前に登録されている
- お気に入り機能（003）は別機能として実装予定
- Phase2では全メニューを一括表示（ページネーションはメニュー数が500件を超えた場合に検討）
- メニュー数は各チェーン店あたり平均10件程度を想定（Phase2では合計160件程度）
- X Post埋め込み表示はPhase2で実装（商品画像代わりの重要機能）
- X Postの読み込みはページ本体の読み込みと分離され、パフォーマンス測定対象外
- Phase2ではお気に入りフィルタの利用にログインが必須（未ログインユーザー向けのローカルストレージ対応はPhase3以降）
- 販売終了日時が未設定の場合、販売終了日時フィールドは非表示とする
- 販売開始日時から1年以上経過したメニューは自動的に一覧から非表示になる（データは削除されない）

## Out of Scope *(optional)*

以下はPhase2 MVPの対象外：

### フロントエンド機能（Phase3以降）

- **チェーン店別フィルタリング**: 特定チェーン店のメニューのみを表示する機能。Phase2では1チェーンあたり1〜5件程度のメニューしかないため、お気に入りフィルタで十分。将来的にはチェーン詳細ページで過去メニューやグランドメニューと合わせて提供予定。
- **ページネーション**: メニュー数が500件を超えた場合は検討、1000件を超えた場合は必須。Phase2では160件程度を想定しているため不要。
- **画像表示**: メニュー画像の直接表示機能（公式画像はチェーン店との提携後に検討、Phase2ではX Post埋め込み経由で画像表示）
- **ソート機能**: 販売開始日時以外のソート（価格順、人気順など）
- **検索機能**: メニュー名やキーワードでの検索
- **メニュー詳細ページ**: メニューの詳細情報を別ページで表示する機能

### その他の機能

- **レビュー表示**: メニューに対するユーザーレビューの表示（Phase3で実装予定）
- **位置情報連携**: 近くのチェーン店の期間限定メニューを表示する機能
- **通知機能**: 新しいメニューが追加されたときの通知
- **比較機能**: 複数のメニューを並べて比較する機能
- **チェーン詳細ページ**: 各チェーンの過去メニュー、グランドメニュー、店舗情報などを表示する機能
